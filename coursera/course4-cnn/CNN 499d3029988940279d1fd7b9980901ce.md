# CNN

WEEK 1 

![Untitled](CNN%20499d3029988940279d1fd7b9980901ce/Untitled.png)

![Untitled](CNN%20499d3029988940279d1fd7b9980901ce/Untitled%201.png)

the below image is of more pixels like 1000 * 1000 * 3
so, no. of input parameters = 3 million so W is of shape  [1000, 3 million] so total we have 3 billion parameters

For computer vision applications, you don't want to be stuck using only tiny little images. You want to use large images. To do that, you need to better implement the **convolution operation**, which is one of the fundamental building blocks of **convolutional neural networks**.

**Edge Detection Example**

Convolution Operator

![Untitled](CNN%20499d3029988940279d1fd7b9980901ce/Untitled%202.png)

Convolving it with the vertical edge detection filter results in detecting the vertical edge down the middle of the image

A `3 by 3` filter or `3 by 3` matrix may look like below, and this is called a vertical edge detector or a vertical edge detection filter. In this matrix, pixels are relatively bright on the left part and relatively dark on the right part.

**1, 0, -1
1, 0, -1
1, 0, -1**

The *convolution operation* gives you a convenient way to specify how to find these **vertical edges** in an image.

**More Edge Detection**

-30 show that there is a light to dark transition

![Untitled](CNN%20499d3029988940279d1fd7b9980901ce/Untitled%203.png)

![Untitled](CNN%20499d3029988940279d1fd7b9980901ce/Untitled%204.png)

![Untitled](CNN%20499d3029988940279d1fd7b9980901ce/Untitled%205.png)

Different filters allow you to find vertical and horizontal edges. The following filter is called a **Sobel filter** the advantage of which is it puts a little bit more weight to the central row, the central pixel, and this makes it maybe a little bit more robust.

> 
> 
> 
> 1, 0, -1
> 2, 0, -2
> 1, 0, -1
> 

Here is another filter called **Scharr filter**:

> 3, 0, -3
10, 0, -10
3, 0, -3
> 

> w1, w2, w3
w4, w5, w6
w7, w8, w9
> 

By just letting all of these numbers be parameters and learning them automatically from data, we find that neural networks can actually learn low level features, can learn features such as edges, even more robustly than computer vision researchers are generally able to code up these things by hand.

**Padding:**

Problems with convolution: 
1)  Every time you apply a convolutional operator the image shrinks. Like a 6 * 6 image shrinks to 4 * 4 if the filter is 3 * 3. so after a lot of layers, we end up with a very small image

2) The edge pixel is used only once for the convolution, while the middle  ones are used a lot more times. Thus, a lot of information from the edges of the image is thrown away.

**SOLUTION : padding**

6 * 6 padded to 8 * 8 (we can pad with even more pixels)

![Untitled](CNN%20499d3029988940279d1fd7b9980901ce/Untitled%206.png)

so after convolving we end up with 6 * 6

*Notations*:

- image size: `n x n`
- convolution size: `f x f`
- padding size: `p`

*Output size after convolution*:

- without padding: `(n-f+1) x (n-f+1)`
- with padding: `(n+2p-f+1) x (n+2p-f+1)`

*Convention*:

- Valid convolutions: no padding
- Same convolutions: output size is the same as the input size
- `f` is usually odd

[https://www.notion.so](https://www.notion.so)